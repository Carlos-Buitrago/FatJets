--- TMVAClassification       : Using input files: ./pp_tt_hadronic_14TeV500kEvtsGenCutT350_CutQCD350_InclusiveCut350_delphes_events.root and ./pp_QCD_14TeV500kEvtsGenCutQCD350_InclusiveCut350_delphes_events.root
DataSetInfo              : [dataset] : Added class "Signal"
                         : Add Tree Delphes of type Signal with 500000 events
DataSetInfo              : [dataset] : Added class "Background"
                         : Add Tree Delphes of type Background with 447443 events
Factory                  : Booking method: DNN_CPU
                         : 
                         : Parsing option string: 
                         : ... "!H:V:ErrorStrategy=CROSSENTROPY:VarTransform=N:WeightInitialization=XAVIERUNIFORM:Layout=TANH|128,TANH|128,TANH|128,LINEAR:TrainingStrategy=LearningRate=1e-2,Momentum=0.9,ConvergenceSteps=20,BatchSize=100,TestRepetitions=1,WeightDecay=1e-4,Regularization=None,DropConfig=0.0+0.5+0.5+0.5:Architecture=CPU"
                         : The following options are set:
                         : - By User:
                         :     <none>
                         : - Default:
                         :     Boost_num: "0" [Number of times the classifier will be boosted]
                         : Parsing option string: 
                         : ... "!H:V:ErrorStrategy=CROSSENTROPY:VarTransform=N:WeightInitialization=XAVIERUNIFORM:Layout=TANH|128,TANH|128,TANH|128,LINEAR:TrainingStrategy=LearningRate=1e-2,Momentum=0.9,ConvergenceSteps=20,BatchSize=100,TestRepetitions=1,WeightDecay=1e-4,Regularization=None,DropConfig=0.0+0.5+0.5+0.5:Architecture=CPU"
                         : The following options are set:
                         : - By User:
                         :     V: "True" [Verbose output (short form of "VerbosityLevel" below - overrides the latter one)]
                         :     VarTransform: "N" [List of variable transformations performed before training, e.g., "D_Background,P_Signal,G,N_AllClasses" for: "Decorrelation, PCA-transformation, Gaussianisation, Normalisation, each for the given class of events ('AllClasses' denotes all events of all classes, if no class indication is given, 'All' is assumed)"]
                         :     H: "False" [Print method-specific help message]
                         :     Layout: "TANH|128,TANH|128,TANH|128,LINEAR" [Layout of the network.]
                         :     ErrorStrategy: "CROSSENTROPY" [Loss function: Mean squared error (regression) or cross entropy (binary classification).]
                         :     WeightInitialization: "XAVIERUNIFORM" [Weight initialization strategy]
                         :     Architecture: "CPU" [Which architecture to perform the training on.]
                         :     TrainingStrategy: "LearningRate=1e-2,Momentum=0.9,ConvergenceSteps=20,BatchSize=100,TestRepetitions=1,WeightDecay=1e-4,Regularization=None,DropConfig=0.0+0.5+0.5+0.5" [Defines the training strategies.]
                         : - Default:
                         :     VerbosityLevel: "Default" [Verbosity level]
                         :     CreateMVAPdfs: "False" [Create PDFs for classifier outputs (signal and background)]
                         :     IgnoreNegWeightsInTraining: "False" [Events with negative weights are ignored in the training (but are included for testing and performance evaluation)]
                         :     InputLayout: "0|0|0" [The Layout of the input]
                         :     BatchLayout: "0|0|0" [The Layout of the batch]
                         :     RandomSeed: "0" [Random seed used for weight initialization and batch shuffling]
                         :     ValidationSize: "20%" [Part of the training data to use for validation. Specify as 0.2 or 20% to use a fifth of the data set as validation set. Specify as 100 to use exactly 100 events. (Default: 20%)]
DNN_CPU                  : [dataset] : Create Transformation "N" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'towerNumberTotal' <---> Output : variable 'towerNumberTotal'
                         : Input : variable 'trackNumberTotal' <---> Output : variable 'trackNumberTotal'
                         : Input : variable 'particleNumberTotal' <---> Output : variable 'particleNumberTotal'
                         : Will now use the CPU architecture with BLAS and IMT support !
Factory                  : Booking method: BDT
                         : 
                         : Rebuilding Dataset dataset
                         : Building event vectors for type 2 Signal
                         : Dataset[dataset] :  create input formulas for tree Delphes
                         : Building event vectors for type 2 Background
                         : Dataset[dataset] :  create input formulas for tree Delphes
DataSetFactory           : [dataset] : Number of events in input trees
                         : 
                         : 
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 225000
                         : Signal     -- testing events             : 275000
                         : Signal     -- training and testing events: 500000
                         : Background -- training events            : 225000
                         : Background -- testing events             : 222443
                         : Background -- training and testing events: 447443
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : --------------------------------------------------------------------------
                         :                      towerNumberTotal trackNumberTotal particleNumberTotal
                         :    towerNumberTotal:           +1.000           +0.776              +0.910
                         :    trackNumberTotal:           +0.776           +1.000              +0.876
                         : particleNumberTotal:           +0.910           +0.876              +1.000
                         : --------------------------------------------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : --------------------------------------------------------------------------
                         :                      towerNumberTotal trackNumberTotal particleNumberTotal
                         :    towerNumberTotal:           +1.000           +0.813              +0.927
                         :    trackNumberTotal:           +0.813           +1.000              +0.901
                         : particleNumberTotal:           +0.927           +0.901              +1.000
                         : --------------------------------------------------------------------------
DataSetFactory           : [dataset] :  
                         : 
Factory                  : Train all methods
Factory                  : [dataset] : Create Transformation "I" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'towerNumberTotal' <---> Output : variable 'towerNumberTotal'
                         : Input : variable 'trackNumberTotal' <---> Output : variable 'trackNumberTotal'
                         : Input : variable 'particleNumberTotal' <---> Output : variable 'particleNumberTotal'
Factory                  : [dataset] : Create Transformation "D" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'towerNumberTotal' <---> Output : variable 'towerNumberTotal'
                         : Input : variable 'trackNumberTotal' <---> Output : variable 'trackNumberTotal'
                         : Input : variable 'particleNumberTotal' <---> Output : variable 'particleNumberTotal'
Factory                  : [dataset] : Create Transformation "P" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'towerNumberTotal' <---> Output : variable 'towerNumberTotal'
                         : Input : variable 'trackNumberTotal' <---> Output : variable 'trackNumberTotal'
                         : Input : variable 'particleNumberTotal' <---> Output : variable 'particleNumberTotal'
Factory                  : [dataset] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'towerNumberTotal' <---> Output : variable 'towerNumberTotal'
                         : Input : variable 'trackNumberTotal' <---> Output : variable 'trackNumberTotal'
                         : Input : variable 'particleNumberTotal' <---> Output : variable 'particleNumberTotal'
Factory                  : [dataset] : Create Transformation "D" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'towerNumberTotal' <---> Output : variable 'towerNumberTotal'
                         : Input : variable 'trackNumberTotal' <---> Output : variable 'trackNumberTotal'
                         : Input : variable 'particleNumberTotal' <---> Output : variable 'particleNumberTotal'
TFHandler_Factory        :            Variable                   Mean                   RMS           [        Min                   Max ]
                         : ------------------------------------------------------------------------------------------------------------------
                         :    towerNumberTotal:               90.413               33.033   [               4.0000               364.00 ]
                         :    trackNumberTotal:               64.394               22.758   [               0.0000               250.00 ]
                         : particleNumberTotal:               538.88               191.63   [               67.000               2694.0 ]
                         : ------------------------------------------------------------------------------------------------------------------
                         : Preparing the Decorrelation transformation...
TFHandler_Factory        :            Variable                   Mean                   RMS           [        Min                   Max ]
                         : ------------------------------------------------------------------------------------------------------------------
                         :    towerNumberTotal:              0.80702               1.0000   [              -4.4962               6.4288 ]
                         :    trackNumberTotal:               1.0102               1.0000   [              -4.4368               6.3893 ]
                         : particleNumberTotal:               2.6384               1.0000   [              0.28490               14.693 ]
                         : ------------------------------------------------------------------------------------------------------------------
                         : Preparing the Principle Component (PCA) transformation...
TFHandler_Factory        :            Variable                   Mean                   RMS           [        Min                   Max ]
                         : ------------------------------------------------------------------------------------------------------------------
                         :    towerNumberTotal:           1.3839e-08               195.00   [              -481.13               2179.0 ]
                         :    trackNumberTotal:           7.3543e-10               13.626   [              -71.800               90.407 ]
                         : particleNumberTotal:           2.5475e-10               10.887   [              -64.186               55.745 ]
                         : ------------------------------------------------------------------------------------------------------------------
                         : Preparing the Gaussian transformation...
                         : Preparing the Decorrelation transformation...
TFHandler_Factory        :            Variable                   Mean                   RMS           [        Min                   Max ]
                         : ------------------------------------------------------------------------------------------------------------------
                         :    towerNumberTotal:            0.0030777               1.0000   [              -4.2374               6.6729 ]
                         :    trackNumberTotal:           -0.0033643               1.0000   [              -5.4797               6.4422 ]
                         : particleNumberTotal:            0.0017276               1.0000   [              -3.5591               4.2259 ]
                         : ------------------------------------------------------------------------------------------------------------------
                         : Ranking input variables (method unspecific)...
IdTransformation         : Ranking result (top variable is best ranked)
                         : --------------------------------------------
                         : Rank : Variable            : Separation
                         : --------------------------------------------
                         :    1 : TrackNumberTotal    : 1.048e-01
                         :    2 : TowerNumberTotal    : 8.713e-02
                         :    3 : ParticleNumberTotal : 3.111e-02
                         : --------------------------------------------
Factory                  : Train method: DNN_CPU for Classification
                         : 
TFHandler_DNN_CPU        :            Variable                   Mean                   RMS           [        Min                   Max ]
                         : ------------------------------------------------------------------------------------------------------------------
                         :    towerNumberTotal:             -0.51993              0.18352   [              -1.0000               1.0000 ]
                         :    trackNumberTotal:             -0.48485              0.18206   [              -1.0000               1.0000 ]
                         : particleNumberTotal:             -0.64074              0.14589   [              -1.0000               1.0000 ]
                         : ------------------------------------------------------------------------------------------------------------------
                         : Start of deep neural network training on CPU using MT,  nthreads = 1
                         : 
TFHandler_DNN_CPU        :            Variable                   Mean                   RMS           [        Min                   Max ]
                         : ------------------------------------------------------------------------------------------------------------------
                         :    towerNumberTotal:             -0.51993              0.18352   [              -1.0000               1.0000 ]
                         :    trackNumberTotal:             -0.48485              0.18206   [              -1.0000               1.0000 ]
                         : particleNumberTotal:             -0.64074              0.14589   [              -1.0000               1.0000 ]
                         : ------------------------------------------------------------------------------------------------------------------
                         : *****   Deep Learning Network *****
DEEP NEURAL NETWORK:   Depth = 4  Input = ( 1, 1, 3 )  Batch size = 100  Loss function = C
	Layer 0	 DENSE Layer: 	 ( Input =     3 , Width =   128 ) 	Output = (  1 ,   100 ,   128 ) 	 Activation Function = Tanh
	Layer 1	 DENSE Layer: 	 ( Input =   128 , Width =   128 ) 	Output = (  1 ,   100 ,   128 ) 	 Activation Function = Tanh	 Dropout prob. = 0.5
	Layer 2	 DENSE Layer: 	 ( Input =   128 , Width =   128 ) 	Output = (  1 ,   100 ,   128 ) 	 Activation Function = Tanh	 Dropout prob. = 0.5
	Layer 3	 DENSE Layer: 	 ( Input =   128 , Width =     1 ) 	Output = (  1 ,   100 ,     1 ) 	 Activation Function = Identity	 Dropout prob. = 0.5
                         : Using 360000 events for training and 90000 for testing
                         : Compute initial loss  on the validation data 
                         : Training phase 1 of 1:  Optimizer ADAM (beta1=0.9,beta2=0.999,eps=1e-07) Learning rate = 0.01 regularization 0 minimum error = 0.690822
                         : --------------------------------------------------------------
                         :      Epoch |   Train Err.   Val. Err.  t(s)/epoch   t(s)/Loss   nEvents/s Conv. Steps
                         : --------------------------------------------------------------
                         :    Start epoch iteration ...
                         :          1 Minimum Test error found - save the configuration 
                         :          1 |     0.533608    0.534329     25.7006      2.1006     15254.3           0
                         :          2 Minimum Test error found - save the configuration 
                         :          2 |     0.528408    0.497207     25.8443     2.03911     15122.8           0
                         :          3 |     0.529523    0.497242     25.7147     1.96403     15157.5           1
                         :          4 |     0.529372    0.502567     25.4807     1.96639     15309.8           2
                         :          5 |     0.528565    0.504614      25.361     1.96467       15387           3
                         :          6 |     0.529031    0.522714     25.3415     1.95772     15395.3           4
                         :          7 |     0.529147    0.513817     25.0995     1.94787     15549.6           5
                         :          8 |     0.530798    0.507029     25.2945     1.94256     15416.3           6
                         :          9 |     0.528629     0.51851     25.4178     1.91604       15318           7
                         :         10 |     0.526137    0.505485     25.5205     1.93545     15263.9           8
                         :         11 |     0.527601    0.498401     25.2516      1.9368     15440.9           9
                         :         12 |     0.527228    0.515669     25.2507     1.89732     15415.3          10
                         :         13 |     0.528359    0.507391       25.14     1.90041     15490.8          11
                         :         14 |     0.527012    0.508303     24.8626     1.96266     15720.6          12
                         :         15 |     0.528455    0.514913     25.1331     1.90909     15501.2          13
                         :         16 |     0.527129    0.497909      24.688     1.90569     15801.7          14
                         :         17 |     0.528964    0.518134     24.5687     1.90192     15882.2          15
                         :         18 |     0.529279    0.497507     25.0357      1.9952     15624.7          16
                         :         19 |     0.527164    0.503262     25.1568     1.99878     15545.4          17
                         :         20 |     0.526484    0.512504     24.9631      2.0081     15682.9          18
                         :         21 |     0.527068    0.500475     24.9583     1.98618     15671.2          19
                         :         22 |     0.529838    0.526996     24.9465     1.96051     15661.7          20
                         :         23 |      0.52973    0.499733     25.0366     1.99539     15624.2          21
                         : 
                         : Elapsed time for training with 450000 events: 582 sec         
                         : Evaluate deep neural network on CPU using batches with size = 100
                         : 
DNN_CPU                  : [dataset] : Evaluation of DNN_CPU on training sample (450000 events)
                         : Elapsed time for evaluation of 450000 events: 10.2 sec       
                         : Creating xml weight file: dataset/weights/TMVAClassification_DNN_CPU.weights.xml
                         : Creating standalone class: dataset/weights/TMVAClassification_DNN_CPU.class.C
Factory                  : Training finished
                         : 
Factory                  : Train method: BDT for Classification
                         : 
BDT                      : #events: (reweighted) sig: 225000 bkg: 225000
                         : #events: (unweighted) sig: 225000 bkg: 225000
                         : Training 850 Decision Trees ... patience please
                         : Elapsed time for training with 450000 events: 146 sec         
BDT                      : [dataset] : Evaluation of BDT on training sample (450000 events)
                         : Elapsed time for evaluation of 450000 events: 15.9 sec       
                         : Creating xml weight file: dataset/weights/TMVAClassification_BDT.weights.xml
                         : Creating standalone class: dataset/weights/TMVAClassification_BDT.class.C
                         : TMVA.root:/dataset/Method_BDT/BDT
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
                         : No variable ranking supplied by classifier: DNN_CPU
BDT                      : Ranking result (top variable is best ranked)
                         : -----------------------------------------------------
                         : Rank : Variable            : Variable Importance
                         : -----------------------------------------------------
                         :    1 : particleNumberTotal : 3.513e-01
                         :    2 : trackNumberTotal    : 3.283e-01
                         :    3 : towerNumberTotal    : 3.205e-01
                         : -----------------------------------------------------
TH1.Print Name  = TrainingHistory_DNN_CPU_trainingError, Entries= 0, Total sum= 12.1575
TH1.Print Name  = TrainingHistory_DNN_CPU_valError, Entries= 0, Total sum= 11.7047
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
                         : Reading weight file: dataset/weights/TMVAClassification_DNN_CPU.weights.xml
                         : Reading weight file: dataset/weights/TMVAClassification_BDT.weights.xml
Factory                  : Test all methods
Factory                  : Test method: DNN_CPU for Classification performance
                         : 
                         : Evaluate deep neural network on CPU using batches with size = 1000
                         : 
TFHandler_DNN_CPU        :            Variable                   Mean                   RMS           [        Min                   Max ]
                         : ------------------------------------------------------------------------------------------------------------------
                         :    towerNumberTotal:             -0.56502              0.18381   [             -0.98889              0.89444 ]
                         :    trackNumberTotal:             -0.53517              0.18008   [              -1.0000              0.88000 ]
                         : particleNumberTotal:             -0.65369              0.15204   [              -1.0175              0.41911 ]
                         : ------------------------------------------------------------------------------------------------------------------
DNN_CPU                  : [dataset] : Evaluation of DNN_CPU on testing sample (497443 events)
                         : Elapsed time for evaluation of 497443 events: 10.1 sec       
Factory                  : Test method: BDT for Classification performance
                         : 
BDT                      : [dataset] : Evaluation of BDT on testing sample (497443 events)
                         : Elapsed time for evaluation of 497443 events: 13.8 sec       
Factory                  : Evaluate all methods
Factory                  : Evaluate classifier: DNN_CPU
                         : 
DNN_CPU                  : [dataset] : Loop over test events and fill histograms with classifier response...
                         : 
                         : Evaluate deep neural network on CPU using batches with size = 1000
                         : 
TFHandler_DNN_CPU        :            Variable                   Mean                   RMS           [        Min                   Max ]
                         : ------------------------------------------------------------------------------------------------------------------
                         :    towerNumberTotal:             -0.51993              0.18352   [              -1.0000               1.0000 ]
                         :    trackNumberTotal:             -0.48485              0.18206   [              -1.0000               1.0000 ]
                         : particleNumberTotal:             -0.64074              0.14589   [              -1.0000               1.0000 ]
                         : ------------------------------------------------------------------------------------------------------------------
TFHandler_DNN_CPU        :            Variable                   Mean                   RMS           [        Min                   Max ]
                         : ------------------------------------------------------------------------------------------------------------------
                         :    towerNumberTotal:             -0.56502              0.18381   [             -0.98889              0.89444 ]
                         :    trackNumberTotal:             -0.53517              0.18008   [              -1.0000              0.88000 ]
                         : particleNumberTotal:             -0.65369              0.15204   [              -1.0175              0.41911 ]
                         : ------------------------------------------------------------------------------------------------------------------
Factory                  : Evaluate classifier: BDT
                         : 
BDT                      : [dataset] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_BDT            :            Variable                   Mean                   RMS           [        Min                   Max ]
                         : ------------------------------------------------------------------------------------------------------------------
                         :    towerNumberTotal:               82.297               33.086   [               6.0000               345.00 ]
                         :    trackNumberTotal:               58.104               22.510   [               0.0000               235.00 ]
                         : particleNumberTotal:               521.87               199.71   [               44.000               1931.0 ]
                         : ------------------------------------------------------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : dataset       BDT            : 0.842
                         : dataset       DNN_CPU        : 0.841
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : dataset              BDT            : 0.186 (0.192)       0.551 (0.553)      0.812 (0.813)
                         : dataset              DNN_CPU        : 0.176 (0.178)       0.554 (0.555)      0.809 (0.810)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:dataset          : Created tree 'TestTree' with 497443 events
                         : 
Dataset:dataset          : Created tree 'TrainTree' with 450000 events
                         : 
Factory                  : Thank you for using TMVA!
                         : For citation information, please visit: http://tmva.sf.net/citeTMVA.html
==> Wrote root file: TMVA.root

